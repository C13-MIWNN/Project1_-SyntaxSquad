<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head th:replace="~{fragments/general :: baseHeader(~{:: title})}">
    <title>Add your recipe</title>
    <link rel="stylesheet" href="/recipe.css">
</head>

<body>
<header>
    <div class="homepage">
        <a href="/" >
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
                <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
            </svg>
            Homepage
        </a>
    </div>

    <h1>Add your own recipe</h1>

    <div class="search">
        <input type="text" placeholder="Search">
        <button>Search</button>
    </div>
</header>

<form th:action="@{/recipe/new}" method="post" th:object="${recipe}">
    <input type="hidden" th:field="*{id}">
    <table>

        <tr>
            <th><label class="recipe-name" for="nameField">Recipe Name</label></th>
            <td><input id="nameField" type="text" th:field="*{recipeName}"></td>
        </tr>
        <tr>

            <td><label class="instructions-section" for="instructionField">Instructions</label></td>
            <td><button type="submit" name="addInstruction">Add instruction</button></td>
        </tr>
        <tr th:each="instruction, rowStat : *{instructions}">
            <td th:text="${rowStat.count}"></td>
            <td>
                <input id="instructionField" type="text"
                   th:field="*{instructions[__${rowStat.index}__]}"
                   th:value="${recipe.instructions}">
            </td>
        </tr>
        <tr>
            <td><label class="ingredient-section" for="ingredientField">Ingredients</label></td>
            <td><button type="submit" name="addIngredient">Add ingredient</button></td>
        </tr>
        <tr th:each="ingredient, rowStat : *{ingredientInRecipeList}">
            <td th:text="${rowStat.count}"></td>
                <td>
                    <select id="ingredientField" th:field="*{ingredientInRecipeList[__${rowStat.index}__].ingredient}">
                        <option
                                th:each="potentialIngredient : ${allIngredients}"
                                th:text="${potentialIngredient.toString()}"
                                th:value="${potentialIngredient.id}">
                        </option>
                    </select>
                </td>
            <td><label class="ingredient-section" for="amountField">Amount</label></td>
            <td>
                <input id="amountField" type="text" th:field="*{ingredientInRecipeList[__${rowStat.index}__].amount}">
            </td>
        </tr>
        <tr>
            <td><label for="tagsField">Tags</label></td>
            <td><button type="submit" name="addTag">Add Tag</button></td>
        </tr>
        <tr th:each="tag, rowStat : *{tags}">
            <td></td>
            <td>
                <select id="tagsField" th:field="*{tags[__${rowStat.index}__]}">
                    <option th:each="potentialTag : ${allTags}"
                            th:text="${potentialTag.tagName}"
                            th:value="${potentialTag.tagName}">
                    </option>
                </select>
            </td>
        </tr>
    </table>

    <button class="save-recipe-button" type="submit" value="Save recipe">Save Recipe</button>
</form>

<p>
    <a th:href="@{/ingredient}">Add a new ingredient</a>
</p>
<p>
    <a th:href="@{/tag}">Add a new tag</a>
</p>

<div th:replace="~{fragments/general :: footer}"></div>
<div th:replace="~{fragments/general :: bottomScripts}"></div>

</body>
</html>